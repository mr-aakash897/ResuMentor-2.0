<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interview - ResuMentor</title>
    <link rel="icon" type="image/svg+xml" href="../assets/favicon.svg">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/theme.css">
    <link rel="stylesheet" href="../css/interview.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>
    <!-- Particle Background Canvas -->
    <canvas id="particles-canvas"></canvas>
    
    <!-- Navigation Bar -->
    <nav class="navbar" id="navbar">
        <div class="navbar-container">
            <a href="../index.html" class="navbar-logo">
                <span class="logo-icon">ğŸ“</span> ResuMentor
            </a>
            
            <!-- Mobile Menu Toggle -->
            <button class="menu-toggle" id="menuToggle" onclick="toggleMobileMenu()">
                <span></span>
                <span></span>
                <span></span>
            </button>
            
            <ul class="nav-menu" id="navMenu">
                <li><a href="../index.html" class="nav-link">Home</a></li>
                <li><a href="../pages/resume-analyzer.html" class="nav-link">Resume Analyzer</a></li>
                <li><a href="#" class="nav-link">Interview</a></li>
                <li><a href="../pages/tips.html" class="nav-link">Tips</a></li>
                <li><a href="../pages/dashboard.html" class="nav-link">Dashboard</a></li>
            </ul>
            <div class="navbar-controls">
                <button id="theme-toggle" class="theme-btn" onclick="toggleTheme()">ğŸŒ™</button>
                <button id="logout-btn" class="login-btn" onclick="logout()">Logout</button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container" style="margin-top: 90px;">
        <!-- Resume Selection (if not coming from resume analyzer) -->
        <div id="resumeSelectionSection" class="resume-selection">
            <div class="selection-header">
                <h2>ğŸ¯ Select a Resume for Interview</h2>
                <p class="selection-subtitle">Choose a previously analyzed resume to start your AI-powered mock interview</p>
            </div>
            <div id="resumeList" class="resume-list"></div>
            
            <!-- Interview Tips Card -->
            <div class="interview-tips-card">
                <h3>ğŸ’¡ Interview Tips</h3>
                <ul class="tips-list">
                    <li><span class="tip-icon">ğŸ¤</span> Speak clearly and at a moderate pace</li>
                    <li><span class="tip-icon">â±ï¸</span> Take your time to structure your answers</li>
                    <li><span class="tip-icon">ğŸ“</span> Use the STAR method for behavioral questions</li>
                    <li><span class="tip-icon">ğŸ”„</span> You can replay questions if needed</li>
                </ul>
            </div>
        </div>

        <!-- Interview Session -->
        <div id="interviewSection" class="interview-container" style="display: none;">
            <!-- Interview Header -->
            <div class="interview-header">
                <div class="header-left">
                    <div class="session-badge">
                        <span class="badge-icon">ğŸ™ï¸</span>
                        <span>Live Session</span>
                    </div>
                    <h2>AI Interview Session</h2>
                    <p id="roleInfo" class="role-info"></p>
                </div>
                <div class="header-right">
                    <div class="timer-section">
                        <span class="timer-label">Time Remaining</span>
                        <div class="timer" id="timer">30:00</div>
                    </div>
                    <div class="progress-section">
                        <span class="progress-label">Progress</span>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                        </div>
                        <span id="questionCount">1/12</span>
                    </div>
                </div>
            </div>

            <!-- Interview Content -->
            <div class="interview-content">
                <!-- Left Panel - AI & Question -->
                <div class="interview-left-panel">
                    <!-- AI Avatar Section -->
                    <div class="ai-avatar-section">
                        <div class="ai-avatar" id="aiAvatar">
                            <div class="avatar-circle">
                                <span class="avatar-icon">ğŸ¤–</span>
                                <div class="speaking-indicator" id="speakingIndicator">
                                    <span></span><span></span><span></span>
                                </div>
                            </div>
                            <p class="avatar-status" id="avatarStatus">AI Interviewer</p>
                        </div>
                    </div>
                    
                    <!-- Question Display -->
                    <div class="question-section">
                        <div class="question-header">
                            <div class="difficulty-badge" id="difficultyBadge">BASIC</div>
                            <button class="replay-btn" onclick="replayQuestion()" title="Replay Question" id="replayBtn">
                                ğŸ”Š Replay
                            </button>
                        </div>
                        <h3>Current Question</h3>
                        <p id="currentQuestion" class="question-text"></p>
                    </div>
                    
                    <!-- Quick Tips Panel -->
                    <div class="quick-tips-panel">
                        <h4>ğŸ’¡ Quick Tips</h4>
                        <div class="tips-scroll">
                            <div class="tip-item"><span>ğŸ¯</span> Be specific with examples</div>
                            <div class="tip-item"><span>â°</span> 2-3 minutes per answer</div>
                            <div class="tip-item"><span>ğŸ“Š</span> Quantify your achievements</div>
                        </div>
                    </div>
                </div>

                <!-- Right Panel - User Response -->
                <div class="interview-right-panel">
                    <!-- User Response Section -->
                    <div class="user-response-section">
                        <h3>Your Response</h3>
                        
                        <!-- Voice Control -->
                        <div class="voice-control-section">
                            <div class="mic-container">
                                <button class="mic-button" id="micButton" onclick="toggleRecording()">
                                    <span class="mic-icon">ğŸ¤</span>
                                    <div class="mic-pulse" id="micPulse"></div>
                                </button>
                                <p class="mic-status" id="micStatus">Click to speak</p>
                            </div>
                            <div class="voice-visualizer" id="voiceVisualizer">
                                <div class="visualizer-bar"></div>
                                <div class="visualizer-bar"></div>
                                <div class="visualizer-bar"></div>
                                <div class="visualizer-bar"></div>
                                <div class="visualizer-bar"></div>
                            </div>
                        </div>

                        <!-- Live Transcript -->
                        <div class="live-transcript-section">
                            <div class="transcript-header">
                                <h4>Live Transcript</h4>
                                <button class="btn btn-small btn-clear" onclick="clearTranscript()" title="Clear">ğŸ—‘ï¸</button>
                            </div>
                            <div id="liveTranscript" class="live-transcript">Start speaking...</div>
                        </div>

                        <!-- Fallback Text Input -->
                        <div class="text-fallback" id="textFallback">
                            <p class="fallback-note">ğŸ’¡ You can also type your answer:</p>
                            <textarea id="userAnswer" placeholder="Type your answer here..." rows="4"></textarea>
                        </div>

                        <!-- Submit Button -->
                        <button class="btn btn-primary btn-submit" onclick="submitAnswer()" id="submitBtn" disabled>
                            âœ“ Submit Answer
                        </button>
                    </div>

                    <!-- Conversation History -->
                    <div class="transcript-section">
                        <h3>ğŸ“ Conversation History</h3>
                        <div id="transcriptBox" class="transcript-box">
                            <p class="transcript-placeholder">Interview transcript will appear here...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Interview Footer -->
            <div class="interview-footer">
                <div class="footer-left">
                    <span class="keyboard-hint">ğŸ’¡ Press <kbd>Space</kbd> to toggle mic</span>
                </div>
                <div class="footer-right">
                    <button class="btn btn-secondary" onclick="confirmEndInterview()">End Session</button>
                    <button class="btn btn-primary" onclick="viewReport()" id="reportBtn" style="display: none;">ğŸ“Š View Report</button>
                </div>
            </div>
        </div>

        <!-- Completion Section -->
        <div id="completionSection" class="completion-section" style="display: none;">
            <div class="completion-card">
                <h2>ğŸ‰ Interview Complete!</h2>
                <div class="completion-stats">
                    <div class="stat">
                        <span class="stat-value" id="finalScore">0</span>
                        <span class="stat-label">Overall Score</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="questionsAnswered">0</span>
                        <span class="stat-label">Questions Answered</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value" id="sessionDuration">0</span>
                        <span class="stat-label">Duration (Minutes)</span>
                    </div>
                </div>
                <div class="completion-buttons">
                    <button class="btn btn-primary" onclick="viewDetailedReport()">ğŸ“Š View Detailed Report</button>
                    <button class="btn btn-secondary" onclick="goToDashboard()">ğŸ“ˆ Go to Dashboard</button>
                </div>
            </div>
        </div>

        <!-- Loading Section -->
        <div id="loadingSection" class="loading-section" style="display: none;">
            <div class="spinner"></div>
            <p id="loadingText">Preparing interview...</p>
        </div>
    </main>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="modal" style="display: none;">
        <div class="modal-content">
            <h3>End Interview Session?</h3>
            <p>Are you sure you want to end the interview? You'll receive a report with your performance.</p>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeConfirmModal()">Cancel</button>
                <button class="btn btn-primary" onclick="endInterview()">End Interview</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <!-- <footer class="footer">
        <div class="container">
            <p>&copy; 2026 ResuMentor. All rights reserved.</p>
        </div>
    </footer> -->

    <script src="../js/api-client.js"></script>
    <script src="../js/ui-utils.js"></script>
    <script src="../js/particles.js"></script>
    <script src="../js/theme.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/interview.js"></script>
</body>
</html>
